# ==================================================
# Development Dockerfile for Unite-Hub
# Lightweight image with node_modules included
# ==================================================

FROM node:20-alpine

LABEL maintainer="Unite-Hub Team"
LABEL version="1.0.0-dev"

# Install security updates and dependencies
RUN apk add --no-cache \
    libc6-compat \
    ca-certificates \
    && apk upgrade --no-cache

WORKDIR /app

# Set environment variables
ENV NODE_ENV=development
ENV NEXT_TELEMETRY_DISABLED=1
ENV NPM_CONFIG_LOGLEVEL=warn

# Copy package files
COPY package.json package-lock.json* ./

# Install dependencies (including devDependencies needed for development)
RUN npm install --legacy-peer-deps

# Copy application code
COPY . .

# Create .env file for build (will be overridden by docker-compose volumes)
RUN touch .env.local

# Expose port 3008
EXPOSE 3008

# Set port environment variable
ENV PORT=3008
ENV HOSTNAME="0.0.0.0"

# Start dev server
CMD ["npm", "run", "dev"]
